# Взаимодействие пользователей с сервисами

## Контекст:

Мы выделили шесть сервисов для реализации MVP и необходимо определиться как пользователь будет с ними взаимодействовать. Http запросы пользователя приходят с мобильного приложения, установленного на его смартфоне. Они маршрутизируются компонентов Messaging Grid. Сервисы разрабатываются независимо и объединены в Process Unit. При этом все они должны в равной мере соответствовать критериям безопасности, а также спецификация их API должна давать возможность удобным образом использовать функционал сервисов. Также есть определенные функции, которые должны реализовывать все сервисы: rate-limiting, кэширование и т.д.
 
## Решение:

Все запросы, которые поступают к сервисам (кроме тех, что посылаются другими сервисами одного Process Unit) должны проходить через слой API Gateway, который будет направлять запросы в сервисам, обеспечивать функции безопасности, rate-limiting, кэширования, управления версиями сервисов и их API.

![Использование API Gateway](https://raw.githubusercontent.com/ariverrun/coursework/main/assets/007%20Communication%20between%20user%20and%20services.png "Использование API Gateway")

## Статус:

принято

## Последствия:

1. API сервисов можно будет менять без изменений на стороне клиента.
2. Функциональности реализованная на стороне нового слоя будет работать одинаково для всех сервисов.
3. Будет проще кэшировать агрегированные данные от нескольких сервисов.
4. Будет проще проводить A/B тестирование нового функционала.
5. Прохожение запросов через дополнительный слой увеличит время его обработки (что в некоторых случаях может нивелироваться кэшированием на уровне этого слоя)
6. Новый слой становится единой точкой отказа.
7. Новый слой должен быть реализован учетом высокой нагрузки, с которой ему предстоит справляться, что увеличивает затраты на разработку.